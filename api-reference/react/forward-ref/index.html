<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />
    <link rel="stylesheet" href="/react-guidebook/umi.css" />
    <script>
      window.routerBase = "/react-guidebook/";
    </script>
    <script>
      //! umi version: 3.2.19
    </script>
    <title>React.forwardRef</title>
  
</head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/react-guidebook-favicon.png&#x27;)" href="/react-guidebook//">React Guidebook</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><a href="/react-guidebook//foundation">基础</a><a href="/react-guidebook//architect">架构</a><a href="/react-guidebook//ecosystem">生态</a><a aria-current="page" class="active" href="/react-guidebook//api-reference">API</a><a href="/react-guidebook//hooks">Hooks</a><a href="/react-guidebook//extensions">扩展</a><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/react-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/react-guidebook-favicon.png&#x27;)" href="/react-guidebook//"></a><h1>React Guidebook</h1><p>React 完全知识体系</p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a href="/react-guidebook//foundation">基础</a></li><li><a href="/react-guidebook//architect">架构</a></li><li><a href="/react-guidebook//ecosystem">生态</a></li><li><a aria-current="page" class="active" href="/react-guidebook//api-reference">API</a></li><li><a href="/react-guidebook//hooks">Hooks</a></li><li><a href="/react-guidebook//extensions">扩展</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/react-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><ul class="__dumi-default-menu-list"><li><a aria-current="page" class="active" href="/react-guidebook//api-reference/react">React</a><ul><li><a href="/react-guidebook//api-reference/react/pure-component"><span>React.PureComponent</span></a></li><li><a href="/react-guidebook//api-reference/react/memo"><span>React.memo</span></a></li><li><a href="/react-guidebook//api-reference/react/create-element"><span>React.createElement</span></a></li><li><a href="/react-guidebook//api-reference/react/clone-element"><span>React.cloneElement</span></a></li><li><a href="/react-guidebook//api-reference/react/is-valid-element"><span>React.isValidElement</span></a></li><li><a href="/react-guidebook//api-reference/react/children"><span>React.children</span></a></li><li><a href="/react-guidebook//api-reference/react/fragment"><span>React.Fragment</span></a></li><li><a href="/react-guidebook//api-reference/react/create-ref"><span>React.createRef</span></a></li><li><a aria-current="page" class="active" href="/react-guidebook//api-reference/react/forward-ref"><span>React.forwardRef</span></a></li><li><a href="/react-guidebook//api-reference/react/lazy"><span>React.lazy</span></a></li><li><a href="/react-guidebook//api-reference/react/suspense"><span>React.Suspense</span></a></li><li><a href="/react-guidebook//api-reference/react/force-update"><span>component.forceUpdate</span></a></li></ul></li><li><a href="/react-guidebook//api-reference/react-dom">ReactDOM</a><ul><li><a href="/react-guidebook//api-reference/react-dom/render"><span>ReactDOM.render</span></a></li><li><a href="/react-guidebook//api-reference/react-dom/hydrate"><span>ReactDOM.hydrate</span></a></li><li><a href="/react-guidebook//api-reference/react-dom/unmount-component-at-node"><span>ReactDOM.componentAtNode</span></a></li><li><a href="/react-guidebook//api-reference/react-dom/find-dom-node"><span>ReactDOM.findDOMNode</span></a></li><li><a href="/react-guidebook//api-reference/react-dom/create-portal"><span>ReactDOM.createPortal</span></a></li></ul></li><li><a href="/react-guidebook//api-reference/react-dom-server">ReactDOMServer</a><ul><li><a href="/react-guidebook//api-reference/react-dom-server/render-to-string"><span>ReactDOMServer.renderToString</span></a></li><li><a href="/react-guidebook//api-reference/react-dom-server/render-to-static-markup"><span>ReactDOMServer.renderToStaticMarkup</span></a></li><li><a href="/react-guidebook//api-reference/react-dom-server/render-to-node-stream"><span>ReactDOMServer.renderToNodeStream</span></a></li><li><a href="/react-guidebook//api-reference/react-dom-server/render-to-static-node-stream"><span>ReactDOMServer.renderToStaticNodeStream</span></a></li></ul></li></ul></div></div><ul class="__dumi-default-layout-toc" role="slug-list"><li title="适用场景" data-depth="2" class=""><a href="/react-guidebook//api-reference/react/forward-ref#适用场景"><span>适用场景</span></a></li><li title="使用方法" data-depth="2" class=""><a href="/react-guidebook//api-reference/react/forward-ref#使用方法"><span>使用方法</span></a></li><li title="使用说明" data-depth="2" class=""><a href="/react-guidebook//api-reference/react/forward-ref#使用说明"><span>使用说明</span></a></li><li title="高频用法" data-depth="2" class=""><a href="/react-guidebook//api-reference/react/forward-ref#高频用法"><span>高频用法</span></a></li><li title="源码解读" data-depth="2" class=""><a href="/react-guidebook//api-reference/react/forward-ref#源码解读"><span>源码解读</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="reactforwardref"><a aria-hidden="true" href="#reactforwardref"><span class="icon icon-link"></span></a>React.forwardRef</h1><blockquote><p>✨ 适用于 React v16.3+</p></blockquote><p><code>React.forwardRef</code> 用于将父组件创建的 <code>ref</code> 引用关联到子组件中的任意元素上。也可以理解为子组件向父组件暴露 DOM 引用。</p><p>除此之外，因为 <code>ref</code> 是为了获取某个节点的实例，但是函数式组件是没有实例的，不存在 <code>this</code> 的，这种时候是拿不到函数式组件的 <code>ref</code> 的，而 <code>React.forwardRef</code> 也能解决这个问题。</p><h2 id="适用场景"><a aria-hidden="true" href="#适用场景"><span class="icon icon-link"></span></a>适用场景</h2><ul><li>获取深层次子孙组件的 DOM 元素</li><li>获取直接 ref 引用的子组件为非 class 声明的函数式组件</li><li>传递 <code>Refs</code> 到高阶组件</li></ul><p>⚠️ 注意与 <code>React.createRef</code> 的对比</p><h2 id="使用方法"><a aria-hidden="true" href="#使用方法"><span class="icon icon-link"></span></a>使用方法</h2><p><code>React.forwardRef</code> 接受 <strong>渲染函数</strong> 作为参数。React 将使用 <code>props</code> 和 <code>ref</code> 作为参数来调用此函数。此函数应返回 React 节点。</p><p>🌰 <strong>示例：</strong></p><div class="__dumi-default-code-block"><pre class="prism-code language-jsx"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="const FancyButton = React.forwardRef((props, ref) =&gt; (
  &lt;button ref={ref} className=&quot;FancyButton&quot;&gt;
    {props.children}
  &lt;/button&gt;
));

// 现在你可以直接获取 DOM 按钮的 ref 了
const ref = React.createRef();

export default &lt;FancyButton ref={ref}&gt;Click me!&lt;/FancyButton&gt;;
" data-status="copy"></button><div class="token-line"><span class="token keyword">const</span><span class="token plain"> FancyButton </span><span class="token operator">=</span><span class="token plain"> React</span><span class="token punctuation">.</span><span class="token function">forwardRef</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token parameter punctuation">,</span><span class="token parameter"> ref</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token tag punctuation">&lt;</span><span class="token tag">button</span><span class="token tag"> </span><span class="token tag attr-name">ref</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">ref</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag attr-name">className</span><span class="token tag attr-value punctuation">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">FancyButton</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">{</span><span class="token plain">props</span><span class="token punctuation">.</span><span class="token plain">children</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token tag punctuation">&lt;/</span><span class="token tag">button</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 现在你可以直接获取 DOM 按钮的 ref 了</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> ref </span><span class="token operator">=</span><span class="token plain"> React</span><span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">export</span><span class="token plain"> </span><span class="token keyword">default</span><span class="token plain"> </span><span class="token tag punctuation">&lt;</span><span class="token tag class-name">FancyButton</span><span class="token tag"> </span><span class="token tag attr-name">ref</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">ref</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag punctuation">&gt;</span><span class="token plain">Click me</span><span class="token operator">!</span><span class="token tag punctuation">&lt;/</span><span class="token tag class-name">FancyButton</span><span class="token tag punctuation">&gt;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p><strong>实现过程：</strong></p><ol><li>通过 <code>React.createRef()</code> 创建 <code>ref</code> 变量，然后在 子组件（<code>FancyButton</code>）属性中通过 <code>ref=<!-- -->{<!-- -->ref<!-- -->}</code> 的方式把这个 <code>ref</code> 和组件关联起来。</li><li>目前为止，如果子组件（<code>FancyButton</code>）是一个通过 Class 或者函数声明的组件，那么就到此为止，我们可以说 <code>ref</code> 变量的 <code>current</code> 属性持有对子组件（<code>FancyButton</code>）实例的引用。</li><li>但是，子组件（<code>FancyButton</code>）经过了 <code>React.fowardRef()</code> 的处理，这个 API 接受两个参数，第二个参数就是 <code>ref</code>，然后把 <code>ref</code> 绑定在 DOM 元素上（button），这样 <code>ref.current</code> 的引用就是 DOM 元素（button）。</li></ol><p><strong>注意事项：</strong></p><ul><li>只在使用 <code>React.forwardRef</code> 定义组件时，第二个参数 <code>ref</code> 才存在</li><li>在项目中组件库中尽量不要使用 <code>React.forwardRef</code>，因为它可能会导致子组件被破坏性更改</li><li>函数组件和 class 组件均不接收 <code>ref</code> 参数，即 <code>props</code> 中不存在 <code>ref</code>，<code>ref</code> 必须独立 <code>props</code> 出来，否则会被 React 特殊处理掉</li></ul><h2 id="使用说明"><a aria-hidden="true" href="#使用说明"><span class="icon icon-link"></span></a>使用说明</h2><p>ForwardRef API 充当传递者角色，实际上是容器组件，能够辅助简化嵌套组件、Component 至 Element 间的 <code>ref</code> 传递，能有效避免 <code>this.ref.ref.ref</code> 的问题。向前传递，这就是叫 <code>forwardRef</code> 的原因。</p><p>需要注意的是，使用 <code>forwardRef</code> 时，该组件必须是函数式组件。原因可能是 React 不想破坏 Class 组件的参考体系。</p><blockquote><p>🖍 与之前提及的获取组件 <code>ref</code> 不能使用函数式组件的区别在哪？</p></blockquote><p>两者有着本质区别，这里获取的依然是 DOM 元素，只不过 <strong>跨级</strong> 了。</p><ul><li><code>React.createRef</code>：绑定子组件容器（最外层 DOM 元素）</li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-jsx"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="import React, { Component } from &#x27;react&#x27;;
import Search from &#x27;./Search&#x27;;

class App extends Component {
  textInput = createRef();

  componentDidMount() {
    this.textInput.current.focus();
  }
  render() {
    return &lt;Search ref={this.textInput} /&gt;;
  }
}

export default App;
" data-status="copy"></button><div class="token-line"><span class="token keyword">import</span><span class="token plain"> React</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> Component </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;react&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">import</span><span class="token plain"> Search </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;./Search&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">App</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token class-name">Component</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  textInput </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token plain">textInput</span><span class="token punctuation">.</span><span class="token plain">current</span><span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token tag punctuation">&lt;</span><span class="token tag class-name">Search</span><span class="token tag"> </span><span class="token tag attr-name">ref</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript keyword">this</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript">textInput</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">export</span><span class="token plain"> </span><span class="token keyword">default</span><span class="token plain"> App</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><ul><li><code>React.forwardRef</code>：父组件创建绑定子孙组件 DOM 元素</li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="import React, { forwardRef } from &#x27;react&#x27;;

const Search = forwardRef((props, ref) =&gt; &lt;input type=&quot;text&quot; ref={ref} /&gt;);

export default Search;
" data-status="copy"></button><div class="token-line"><span class="token keyword module">import</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> forwardRef </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&#x27;react&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> </span><span class="token maybe-class-name">Search</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">forwardRef</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token parameter punctuation">,</span><span class="token parameter"> ref</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain">input type</span><span class="token operator">=</span><span class="token string">&quot;text&quot;</span><span class="token plain"> ref</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token plain">ref</span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword module">export</span><span class="token plain"> </span><span class="token keyword module">default</span><span class="token plain"> </span><span class="token maybe-class-name">Search</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>事实上，一旦被 <code>forwardRef</code> 包裹的子组件接收到了 <code>ref</code> 参数，它可以继续将 <code>ref</code> 往下传递。</p><p>之后 <code>ref</code> 就变成了一个普通的 <code>props</code>，直到它被挂载到某个 DOM 元素的 <code>ref</code> 属性上。</p><p>其实 <code>ref</code> 回调也是可以 <strong>跨多级</strong> 传递的，原理同上。</p><div class="__dumi-default-code-block"><pre class="prism-code language-jsx"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="import React, { Component, createRef } from &#x27;react&#x27;;

class Input extends Component {
  render() {
    return &lt;input type=&quot;text&quot; ref={this.props.inputRef} /&gt;;
  }
}

const Search = forwardRef((props, ref) =&gt; &lt;Input inputRef={ref} /&gt;);

class App extends Component {
  textInput = createRef();

  render() {
    return &lt;Search ref={this.textInput} /&gt;;
  }
}

export default App;
" data-status="copy"></button><div class="token-line"><span class="token keyword">import</span><span class="token plain"> React</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> Component</span><span class="token punctuation">,</span><span class="token plain"> createRef </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">from</span><span class="token plain"> </span><span class="token string">&#x27;react&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">Input</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token class-name">Component</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token tag punctuation">&lt;</span><span class="token tag">input</span><span class="token tag"> </span><span class="token tag attr-name">type</span><span class="token tag attr-value punctuation">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">text</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">ref</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript keyword">this</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript">props</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript">inputRef</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> Search </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">forwardRef</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token parameter punctuation">,</span><span class="token parameter"> ref</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token tag punctuation">&lt;</span><span class="token tag class-name">Input</span><span class="token tag"> </span><span class="token tag attr-name">inputRef</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">ref</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">App</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token class-name">Component</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  textInput </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token tag punctuation">&lt;</span><span class="token tag class-name">Search</span><span class="token tag"> </span><span class="token tag attr-name">ref</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript keyword">this</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript">textInput</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">export</span><span class="token plain"> </span><span class="token keyword">default</span><span class="token plain"> App</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h2 id="高频用法"><a aria-hidden="true" href="#高频用法"><span class="icon icon-link"></span></a>高频用法</h2><p>常在高阶组件中使用 <code>React.forwardRef</code></p><div class="__dumi-default-code-block"><pre class="prism-code language-jsx"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="function enhance(WrappedComponent) {
  class Enhance extends React.Component {
    render() {
      const { forwardRef, ...restProps } = this.props;
      // 将定义的 prop 属性 forwardRef 定义为 ref
      return &lt;WrappedComponent ref={forwardedRef} {...restProps} /&gt;;
    }
  }
  // 注意 React.forwardRef 回调的第二个参数 ref
  // 我们可以将其作为常规 prop 属性传递给 Enhance，例如 forwardedRef
  // 然后它就可以被挂载到被 Enhance 包裹的子组件上
  return React.forwardRef((props, ref) =&gt; &lt;Enhance {...props} forwardedRef={ref} /&gt;);
}

// 子组件
class MyComponent extends React.Component {
  render(){
    return (
      &lt;input type=&#x27;text&#x27; /&gt;
    )
  }
}

// EnhancedComponent 会渲染一个高阶组件 enhance(MyComponent)
const EnhancedComponent = enhance(MyComponent);

const ref = React.createRef();

// 我们导入的 EnahcnedComponent 组件是高阶组件（HOC）Enhance
// 通过 React.forward 将 ref 将指向了 Enhance 内部的 MyComponent 组件
// 这意味着我们可以直接调用 ref.current.focus() 方法
&lt;EnhancedComponent label=&quot;Click Me&quot; handleClick={handleClick} ref={ref} /&gt;;
" data-status="copy"></button><div class="token-line"><span class="token keyword">function</span><span class="token plain"> </span><span class="token function">enhance</span><span class="token punctuation">(</span><span class="token parameter">WrappedComponent</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">Enhance</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token class-name">React</span><span class="token class-name punctuation">.</span><span class="token class-name">Component</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">const</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> forwardRef</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token operator">...</span><span class="token plain">restProps </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token plain">props</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token comment">// 将定义的 prop 属性 forwardRef 定义为 ref</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token tag punctuation">&lt;</span><span class="token tag class-name">WrappedComponent</span><span class="token tag"> </span><span class="token tag attr-name">ref</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">forwardedRef</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag spread punctuation">{</span><span class="token tag spread punctuation">...</span><span class="token tag spread attr-value">restProps</span><span class="token tag spread punctuation">}</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// 注意 React.forwardRef 回调的第二个参数 ref</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// 我们可以将其作为常规 prop 属性传递给 Enhance，例如 forwardedRef</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">// 然后它就可以被挂载到被 Enhance 包裹的子组件上</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">return</span><span class="token plain"> React</span><span class="token punctuation">.</span><span class="token function">forwardRef</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token parameter punctuation">,</span><span class="token parameter"> ref</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token tag punctuation">&lt;</span><span class="token tag class-name">Enhance</span><span class="token tag"> </span><span class="token tag spread punctuation">{</span><span class="token tag spread punctuation">...</span><span class="token tag spread attr-value">props</span><span class="token tag spread punctuation">}</span><span class="token tag"> </span><span class="token tag attr-name">forwardedRef</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">ref</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 子组件</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">MyComponent</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token class-name">React</span><span class="token class-name punctuation">.</span><span class="token class-name">Component</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token tag punctuation">&lt;</span><span class="token tag">input</span><span class="token tag"> </span><span class="token tag attr-name">type</span><span class="token tag attr-value punctuation">=</span><span class="token tag attr-value punctuation">&#x27;</span><span class="token tag attr-value">text</span><span class="token tag attr-value punctuation">&#x27;</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// EnhancedComponent 会渲染一个高阶组件 enhance(MyComponent)</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> EnhancedComponent </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">enhance</span><span class="token punctuation">(</span><span class="token plain">MyComponent</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> ref </span><span class="token operator">=</span><span class="token plain"> React</span><span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 我们导入的 EnahcnedComponent 组件是高阶组件（HOC）Enhance</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 通过 React.forward 将 ref 将指向了 Enhance 内部的 MyComponent 组件</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// 这意味着我们可以直接调用 ref.current.focus() 方法</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token tag punctuation">&lt;</span><span class="token tag class-name">EnhancedComponent</span><span class="token tag"> </span><span class="token tag attr-name">label</span><span class="token tag attr-value punctuation">=</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag attr-value">Click Me</span><span class="token tag attr-value punctuation">&quot;</span><span class="token tag"> </span><span class="token tag attr-name">handleClick</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">handleClick</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag attr-name">ref</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">ref</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h2 id="源码解读"><a aria-hidden="true" href="#源码解读"><span class="icon icon-link"></span></a>源码解读</h2><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="export default function forwardRef&lt;Props, ElementType: React$ElementType&gt;(
  render: (props: Props, ref: React$Ref&lt;ElementType&gt;) =&gt; React$Node
) {
  if (__DEV__) {
    if (render != null &amp;&amp; render.$typeof === REACT_MEMO_TYPE) {
      warningWithoutStack(
        false,
        &#x27;forwardRef requires a render function but received a `memo` &#x27; +
          &#x27;component. Instead of forwardRef(memo(...)), use &#x27; +
          &#x27;memo(forwardRef(...)).&#x27;
      );
    } else if (typeof render !== &#x27;function&#x27;) {
      warningWithoutStack(
        false,
        &#x27;forwardRef requires a render function but was given %s.&#x27;,
        render === null ? &#x27;null&#x27; : typeof render
      );
    } else {
      warningWithoutStack(
        // Do not warn for 0 arguments because it could be due to usage of the &#x27;arguments&#x27; object
        render.length === 0 || render.length === 2,
        &#x27;forwardRef render functions accept exactly two parameters: props and ref. %s&#x27;,
        render.length === 1
          ? &#x27;Did you forget to use the ref parameter?&#x27;
          : &#x27;Any additional parameter will be undefined.&#x27;
      );
    }

    if (render != null) {
      warningWithoutStack(
        render.defaultProps == null &amp;&amp; render.propTypes == null,
        &#x27;forwardRef render functions do not support propTypes or defaultProps. &#x27; +
          &#x27;Did you accidentally pass a React component?&#x27;
      );
    }
  }

  /**
   * REACT_FORWARD_REF_TYPE 并不是 React.forwardRef 创建的实例的 $typeof
   * React.forwardRef 返回的是一个对象，而 ref 是通过实例的参数形式传递进去的，
   * 实际上，React.forwardRef 返回的是一个 ReactElement，它的 $typeof 也就是 REACT_ELEMENT_TYPE
   * 而 返回的对象 是作为 ReactElement 的 type 存在
   */
  return {
    // 返回一个对象
    $typeof: REACT_FORWARD_REF_TYPE, // 并不是 React.forwardRef 创建的实例的 $typeof
    render, // 函数组件
  };
}
" data-status="copy"></button><div class="token-line"><span class="token keyword module">export</span><span class="token plain"> </span><span class="token keyword module">default</span><span class="token plain"> </span><span class="token keyword">function</span><span class="token plain"> forwardRef</span><span class="token operator">&lt;</span><span class="token maybe-class-name">Props</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token maybe-class-name">ElementType</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token maybe-class-name">React$ElementType</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function-variable function">render</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token parameter punctuation">:</span><span class="token parameter"> Props</span><span class="token parameter punctuation">,</span><span class="token parameter"> ref</span><span class="token parameter punctuation">:</span><span class="token parameter"> React$Ref</span><span class="token parameter operator">&lt;</span><span class="token parameter">ElementType</span><span class="token parameter operator">&gt;</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token arrow operator">=&gt;</span><span class="token plain"> </span><span class="token maybe-class-name">React$Node</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">__DEV__</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">render </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token keyword null nil">null</span><span class="token plain"> </span><span class="token operator">&amp;&amp;</span><span class="token plain"> render</span><span class="token punctuation">.</span><span class="token property-access">$</span><span class="token keyword">typeof</span><span class="token plain"> </span><span class="token operator">===</span><span class="token plain"> </span><span class="token constant">REACT_MEMO_TYPE</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token function">warningWithoutStack</span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token string">&#x27;forwardRef requires a render function but received a `memo` &#x27;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token string">&#x27;component. Instead of forwardRef(memo(...)), use &#x27;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token string">&#x27;memo(forwardRef(...)).&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">else</span><span class="token plain"> </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token plain"> render </span><span class="token operator">!==</span><span class="token plain"> </span><span class="token string">&#x27;function&#x27;</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token function">warningWithoutStack</span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token string">&#x27;forwardRef requires a render function but was given %s.&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        render </span><span class="token operator">===</span><span class="token plain"> </span><span class="token keyword null nil">null</span><span class="token plain"> </span><span class="token operator">?</span><span class="token plain"> </span><span class="token string">&#x27;null&#x27;</span><span class="token plain"> </span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token keyword">typeof</span><span class="token plain"> render</span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">else</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token function">warningWithoutStack</span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token comment">// Do not warn for 0 arguments because it could be due to usage of the &#x27;arguments&#x27; object</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        render</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator">===</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> </span><span class="token operator">||</span><span class="token plain"> render</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator">===</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token string">&#x27;forwardRef render functions accept exactly two parameters: props and ref. %s&#x27;</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        render</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token plain"> </span><span class="token operator">===</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token operator">?</span><span class="token plain"> </span><span class="token string">&#x27;Did you forget to use the ref parameter?&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;Any additional parameter will be undefined.&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">render </span><span class="token operator">!=</span><span class="token plain"> </span><span class="token keyword null nil">null</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token function">warningWithoutStack</span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        render</span><span class="token punctuation">.</span><span class="token property-access">defaultProps</span><span class="token plain"> </span><span class="token operator">==</span><span class="token plain"> </span><span class="token keyword null nil">null</span><span class="token plain"> </span><span class="token operator">&amp;&amp;</span><span class="token plain"> render</span><span class="token punctuation">.</span><span class="token property-access">propTypes</span><span class="token plain"> </span><span class="token operator">==</span><span class="token plain"> </span><span class="token keyword null nil">null</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token string">&#x27;forwardRef render functions do not support propTypes or defaultProps. &#x27;</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token string">&#x27;Did you accidentally pass a React component?&#x27;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"> </span><span class="token doc-comment comment"> /**</span></div><div class="token-line"><span class="token doc-comment comment">   * REACT_FORWARD_REF_TYPE 并不是 React.forwardRef 创建的实例的 $typeof</span></div><div class="token-line"><span class="token doc-comment comment">   * React.forwardRef 返回的是一个对象，而 ref 是通过实例的参数形式传递进去的，</span></div><div class="token-line"><span class="token doc-comment comment">   * 实际上，React.forwardRef 返回的是一个 ReactElement，它的 $typeof 也就是 REACT_ELEMENT_TYPE</span></div><div class="token-line"><span class="token doc-comment comment">   * 而 返回的对象 是作为 ReactElement 的 type 存在</span></div><div class="token-line"><span class="token doc-comment comment">   */</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// 返回一个对象</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    $</span><span class="token keyword">typeof</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token constant">REACT_FORWARD_REF_TYPE</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token comment">// 并不是 React.forwardRef 创建的实例的 $typeof</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    render</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token comment">// 函数组件</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/React-GuideBook/edit/master/docs/api-reference/react/forward-ref.md">Edit this doc on GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="Last Update: ">9/1/2020, 6:20:53 AM</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/react-guidebook/umi.js"></script>
    <script src="/react-guidebook/docs__api-reference__react__forward-ref.md.js"></script>
  </body>
</html>
