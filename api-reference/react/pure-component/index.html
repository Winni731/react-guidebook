<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no"
    />
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />
    <link rel="stylesheet" href="/react-guidebook/umi.css" />
    <script>
      window.routerBase = "/react-guidebook/";
    </script>
    <script>
      //! umi version: 3.2.19
    </script>
    <title>React.PureComponent</title>
  
</head>
  <body>
    <div id="root"><div class="__dumi-default-layout" data-show-sidemenu="true" data-show-slugs="true" data-site-mode="true" data-gapless="false"><div class="__dumi-default-navbar" data-mode="site"><button class="__dumi-default-navbar-toggle"></button><a class="__dumi-default-navbar-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/react-guidebook-favicon.png&#x27;)" href="/react-guidebook//">React Guidebook</a><nav><div class="__dumi-default-search"><input type="search" class="__dumi-default-search-input" value=""/><ul></ul></div><a href="/react-guidebook//foundation">基础</a><a href="/react-guidebook//architect">架构</a><a href="/react-guidebook//ecosystem">生态</a><a aria-current="page" class="active" href="/react-guidebook//api-reference">API</a><a href="/react-guidebook//hooks">Hooks</a><a href="/react-guidebook//extensions">扩展</a><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/react-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div><div class="__dumi-default-menu" data-mode="site"><div class="__dumi-default-menu-inner"><div class="__dumi-default-menu-header"><a class="__dumi-default-menu-logo" style="background-image:url(&#x27;http://img.mrsingsing.com/react-guidebook-favicon.png&#x27;)" href="/react-guidebook//"></a><h1>React Guidebook</h1><p>React 完全知识体系</p></div><div class="__dumi-default-menu-mobile-area"><ul class="__dumi-default-menu-nav-list"><li><a href="/react-guidebook//foundation">基础</a></li><li><a href="/react-guidebook//architect">架构</a></li><li><a href="/react-guidebook//ecosystem">生态</a></li><li><a aria-current="page" class="active" href="/react-guidebook//api-reference">API</a></li><li><a href="/react-guidebook//hooks">Hooks</a></li><li><a href="/react-guidebook//extensions">扩展</a></li><li><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/react-guidebook">Github<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><ul class="__dumi-default-menu-list"><li><a aria-current="page" class="active" href="/react-guidebook//api-reference/react">React</a><ul><li><a aria-current="page" class="active" href="/react-guidebook//api-reference/react/pure-component"><span>React.PureComponent</span></a></li><li><a href="/react-guidebook//api-reference/react/memo"><span>React.memo</span></a></li><li><a href="/react-guidebook//api-reference/react/create-element"><span>React.createElement</span></a></li><li><a href="/react-guidebook//api-reference/react/clone-element"><span>React.cloneElement</span></a></li><li><a href="/react-guidebook//api-reference/react/is-valid-element"><span>React.isValidElement</span></a></li><li><a href="/react-guidebook//api-reference/react/children"><span>React.children</span></a></li><li><a href="/react-guidebook//api-reference/react/fragment"><span>React.Fragment</span></a></li><li><a href="/react-guidebook//api-reference/react/create-ref"><span>React.createRef</span></a></li><li><a href="/react-guidebook//api-reference/react/forward-ref"><span>React.forwardRef</span></a></li><li><a href="/react-guidebook//api-reference/react/lazy"><span>React.lazy</span></a></li><li><a href="/react-guidebook//api-reference/react/suspense"><span>React.Suspense</span></a></li><li><a href="/react-guidebook//api-reference/react/force-update"><span>component.forceUpdate</span></a></li></ul></li><li><a href="/react-guidebook//api-reference/react-dom">ReactDOM</a><ul><li><a href="/react-guidebook//api-reference/react-dom/render"><span>ReactDOM.render</span></a></li><li><a href="/react-guidebook//api-reference/react-dom/hydrate"><span>ReactDOM.hydrate</span></a></li><li><a href="/react-guidebook//api-reference/react-dom/unmount-component-at-node"><span>ReactDOM.componentAtNode</span></a></li><li><a href="/react-guidebook//api-reference/react-dom/find-dom-node"><span>ReactDOM.findDOMNode</span></a></li><li><a href="/react-guidebook//api-reference/react-dom/create-portal"><span>ReactDOM.createPortal</span></a></li></ul></li><li><a href="/react-guidebook//api-reference/react-dom-server">ReactDOMServer</a><ul><li><a href="/react-guidebook//api-reference/react-dom-server/render-to-string"><span>ReactDOMServer.renderToString</span></a></li><li><a href="/react-guidebook//api-reference/react-dom-server/render-to-static-markup"><span>ReactDOMServer.renderToStaticMarkup</span></a></li><li><a href="/react-guidebook//api-reference/react-dom-server/render-to-node-stream"><span>ReactDOMServer.renderToNodeStream</span></a></li><li><a href="/react-guidebook//api-reference/react-dom-server/render-to-static-node-stream"><span>ReactDOMServer.renderToStaticNodeStream</span></a></li></ul></li></ul></div></div><ul class="__dumi-default-layout-toc" role="slug-list"><li title="实现原理" data-depth="2" class=""><a href="/react-guidebook//api-reference/react/pure-component#实现原理"><span>实现原理</span></a></li><li title="使用指南" data-depth="2" class=""><a href="/react-guidebook//api-reference/react/pure-component#使用指南"><span>使用指南</span></a></li><li title="重建引用数据类型" data-depth="3" class=""><a href="/react-guidebook//api-reference/react/pure-component#重建引用数据类型"><span>重建引用数据类型</span></a></li><li title="内联函数" data-depth="3" class=""><a href="/react-guidebook//api-reference/react/pure-component#内联函数"><span>内联函数</span></a></li><li title="空引用类型" data-depth="3" class=""><a href="/react-guidebook//api-reference/react/pure-component#空引用类型"><span>空引用类型</span></a></li><li title="与内置生命周期函数冲突" data-depth="3" class=""><a href="/react-guidebook//api-reference/react/pure-component#与内置生命周期函数冲突"><span>与内置生命周期函数冲突</span></a></li><li title="老版本兼容写法" data-depth="3" class=""><a href="/react-guidebook//api-reference/react/pure-component#老版本兼容写法"><span>老版本兼容写法</span></a></li><li title="同类型对比" data-depth="2" class=""><a href="/react-guidebook//api-reference/react/pure-component#同类型对比"><span>同类型对比</span></a></li><li title="与无状态组件对比" data-depth="3" class=""><a href="/react-guidebook//api-reference/react/pure-component#与无状态组件对比"><span>与无状态组件对比</span></a></li><li title="与 memo 对比" data-depth="3" class=""><a href="/react-guidebook//api-reference/react/pure-component#与-memo-对比"><span>与 memo 对比</span></a></li></ul><div class="__dumi-default-layout-content"><div class="markdown"><h1 id="reactpurecomponent"><a aria-hidden="true" href="#reactpurecomponent"><span class="icon icon-link"></span></a>React.PureComponent</h1><p>在 React Component 的生命周期中，有一个 <code>shouldComponentUpdate</code> 方法。这个方法默认返回值是 <code>true</code>。</p><p>这意味着就算没有改变组件的 <code>props</code> 或者 <code>state</code>，也会导致组件的重绘，也就是会重新执行 <code>render</code> 函数。这就经常导致组件因为不相关数据的改变导致重绘，这极大的降低了 React 的渲染效率。</p><p>PureComponent 与 Component 的不同在于，PureComponent 内部会基于 <code>props</code> 和 <code>state</code> 重新渲染前后自动执行一次 <strong>第一层</strong> 的 <code>shallowEqual</code>（浅比较），来决定是否更新组件，浅比较类似于浅拷贝。</p><p>📌 <strong>组件函数要点：</strong></p><ul><li>引用和第一层数据都没有发生改变，<code>render</code> 方法就不会触发重新渲染</li><li>虽然第一层数据没变，但引用变了，就会造成虚拟 DOM 计算的浪费 <a href="#%E6%80%A7%E8%83%BD%E9%97%AE%E9%A2%98">🌐 性能问题</a></li><li>第一层数据改变，但引用没变，会造成不渲染，所以需要很小心地操作数据</li></ul><h2 id="实现原理"><a aria-hidden="true" href="#实现原理"><span class="icon icon-link"></span></a>实现原理</h2><p>当组件更新时，如果组件的  <code>props</code>  和  <code>state</code>  都没发生改变，<code>render</code>  方法就不会触发，省去  Virtual DOM  的生成和比对过程，达到提升性能的目的。</p><p><strong>需要注意的是，PureComponent 自动使用浅比较判断组件是否需要重绘。</strong></p><div class="__dumi-default-code-block"><pre class="prism-code language-jsx"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="if (this._compositeType === CompositeTypes.PureClass) {
  shouldUpdate = !shallowEqual(prevProps, nextProps) || !shallowEqual(inst.state, nextState);
}
" data-status="copy"></button><div class="token-line"><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token plain">_compositeType </span><span class="token operator">===</span><span class="token plain"> CompositeTypes</span><span class="token punctuation">.</span><span class="token plain">PureClass</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  shouldUpdate </span><span class="token operator">=</span><span class="token plain"> </span><span class="token operator">!</span><span class="token function">shallowEqual</span><span class="token punctuation">(</span><span class="token plain">prevProps</span><span class="token punctuation">,</span><span class="token plain"> nextProps</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">||</span><span class="token plain"> </span><span class="token operator">!</span><span class="token function">shallowEqual</span><span class="token punctuation">(</span><span class="token plain">inst</span><span class="token punctuation">.</span><span class="token plain">state</span><span class="token punctuation">,</span><span class="token plain"> nextState</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>而  <code>shallowEqual</code>  又做了什么呢？会比较  <code>Object.keys(state | props)</code>  的长度是否一致，每一个  <code>key</code>  是否两者都有，并且是否是一个引用，也就是只比较了第一层的值，确实很浅，所以深层的嵌套数据是对比不出来的。</p><h2 id="使用指南"><a aria-hidden="true" href="#使用指南"><span class="icon icon-link"></span></a>使用指南</h2><h3 id="重建引用数据类型"><a aria-hidden="true" href="#重建引用数据类型"><span class="icon icon-link"></span></a>重建引用数据类型</h3><p>由于 <code>shouldCompoenntUpdate</code> 前后 <code>props</code> 和 <code>state</code> 只进行浅比较，也就是引用比较，因此变更数组或对象类型数据需要在原来数据基础上重新建立新的数组引用或对象引用。</p><ul><li>数组<ul><li>使用数组的 <code>concat</code> 方法： <code>[].concat(options)</code></li><li>使用扩展运算符：<code>[...options]</code></li></ul></li><li>对象<ul><li>使用对象的 <code>assign</code> 方法：<code>Object.assign(<!-- -->{}<!-- -->, options)</code></li><li>使用扩展运算符：<code>{<!-- -->...options<!-- -->}</code></li></ul></li></ul><div class="__dumi-default-code-block"><pre class="prism-code language-jsx"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="class App extends PureComponent {
  state = {
    items: [1, 2, 3],
  };
  handleClick = () =&gt; {
    const { items } = this.state;
    items.pop();
    // Bad 不会重新渲染
    this.setState({ items });
    // Better
    this.setState({ items: [].concat(items) });
  };
  render() {
    return (
      &lt;div&gt;
        &lt;ul&gt;
          {this.state.items.map(i =&gt; (
            &lt;li key={i}&gt;{i}&lt;/li&gt;
          ))}
        &lt;/ul&gt;
        &lt;button onClick={this.handleClick}&gt;delete&lt;/button&gt;
      &lt;/div&gt;
    );
  }
}
" data-status="copy"></button><div class="token-line"><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">App</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token class-name">PureComponent</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  state </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    items</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function-variable function">handleClick</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">const</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> items </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token plain">state</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    items</span><span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// Bad 不会重新渲染</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"> items </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token comment">// Better</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"> items</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token plain">items</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token tag punctuation">&lt;</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token tag punctuation">&lt;</span><span class="token tag">ul</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token plain">state</span><span class="token punctuation">.</span><span class="token plain">items</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">i</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token tag punctuation">&lt;</span><span class="token tag">li</span><span class="token tag"> </span><span class="token tag attr-name">key</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">i</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag punctuation">&gt;</span><span class="token punctuation">{</span><span class="token plain">i</span><span class="token punctuation">}</span><span class="token tag punctuation">&lt;/</span><span class="token tag">li</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token tag punctuation">&lt;/</span><span class="token tag">ul</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token tag punctuation">&lt;</span><span class="token tag">button</span><span class="token tag"> </span><span class="token tag attr-name">onClick</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript keyword">this</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript">handleClick</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag punctuation">&gt;</span><span class="token keyword">delete</span><span class="token tag punctuation">&lt;/</span><span class="token tag">button</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token tag punctuation">&lt;/</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="内联函数"><a aria-hidden="true" href="#内联函数"><span class="icon icon-link"></span></a>内联函数</h3><p>函数也经常作为 <code>props</code> 传递，由于每次需要为内联函数创建一个新的实例，所以每次函数都会指向不同的内存地址。</p><p><strong>箭头函数写法</strong>：</p><div class="__dumi-default-code-block"><pre class="prism-code language-jsx"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="render() {
     &lt;MyInput onChange={(e) =&gt; this.props.update(e.target.value)} /&gt;;
}
" data-status="copy"></button><div class="token-line"><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">     </span><span class="token tag punctuation">&lt;</span><span class="token tag class-name">MyInput</span><span class="token tag"> </span><span class="token tag attr-name">onChange</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript parameter">e</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript"> </span><span class="token tag script language-javascript operator">=&gt;</span><span class="token tag script language-javascript"> </span><span class="token tag script language-javascript keyword">this</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript">props</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript function">update</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript">e</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript">target</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript">value</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p><strong>利用 <code>bind</code> 函数绑定指针</strong>：</p><div class="__dumi-default-code-block"><pre class="prism-code language-jsx"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="update(e) {
     this.props.update(e.target.value);
}
render() {
     return &lt;MyInput onChange={this.update.bind(this)} /&gt;;
}
" data-status="copy"></button><div class="token-line"><span class="token function">update</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">     </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token plain">props</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token plain">e</span><span class="token punctuation">.</span><span class="token plain">target</span><span class="token punctuation">.</span><span class="token plain">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">     </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token tag punctuation">&lt;</span><span class="token tag class-name">MyInput</span><span class="token tag"> </span><span class="token tag attr-name">onChange</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript keyword">this</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript function">update</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript function">bind</span><span class="token tag script language-javascript punctuation">(</span><span class="token tag script language-javascript keyword">this</span><span class="token tag script language-javascript punctuation">)</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>以上两个例子都会导致每次 <code>render</code> 时都会创建新的函数实例。</p><p>📌 为了解决这个问题，需要提前至构造函数 <code>constructor</code> 绑定函数调用的 <code>this</code> 指针：</p><div class="__dumi-default-code-block"><pre class="prism-code language-jsx"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="constructor(props) {
    super(props);
    this.update = this.update.bind(this);
}
update(e) {
    this.props.update(e.target.value);
}
render() {
    return &lt;MyInput onChange={this.update} /&gt;;
}
" data-status="copy"></button><div class="token-line"><span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">super</span><span class="token punctuation">(</span><span class="token plain">props</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token plain">update </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">update</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token plain">props</span><span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token plain">e</span><span class="token punctuation">.</span><span class="token plain">target</span><span class="token punctuation">.</span><span class="token plain">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token tag punctuation">&lt;</span><span class="token tag class-name">MyInput</span><span class="token tag"> </span><span class="token tag attr-name">onChange</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript keyword">this</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript">update</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="空引用类型"><a aria-hidden="true" href="#空引用类型"><span class="icon icon-link"></span></a>空引用类型</h3><p>有时候后台返回的数据中，数组长度为 0 或者对象没有属性会直接给个 <code>null</code>，这时候我们需要做些容错。</p><div class="__dumi-default-code-block"><pre class="prism-code language-jsx"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="class App extends PureComponent {
  state = {
    items: [{ name: &#x27;abc&#x27; }, null, { name: &#x27;c&#x27; }],
  };

  store = (id, value) =&gt; {
    const { items } = this.state;
    items[id] = assign({}, items[id], { name: value });
    this.setState({ items: [].concat(items) });
  };

  render() {
    return (
      &lt;div&gt;
        &lt;ul&gt;
          {this.state.items.map((i, k) =&gt; (
            &lt;Item style={{ color: &#x27;red&#x27; }} store={this.store} key={k} id={k} data={i || {}} /&gt;
          ))}
        &lt;/ul&gt;
      &lt;/div&gt;
    );
  }
}
" data-status="copy"></button><div class="token-line"><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">App</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token class-name">PureComponent</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  state </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    items</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token plain"> name</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;abc&#x27;</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> name</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;c&#x27;</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function-variable function">store</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token parameter">id</span><span class="token parameter punctuation">,</span><span class="token parameter"> value</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">const</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> items </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token plain">state</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    items</span><span class="token punctuation">[</span><span class="token plain">id</span><span class="token punctuation">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token plain"> items</span><span class="token punctuation">[</span><span class="token plain">id</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> name</span><span class="token punctuation">:</span><span class="token plain"> value </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token plain"> items</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token plain">items</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token keyword">return</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token tag punctuation">&lt;</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token tag punctuation">&lt;</span><span class="token tag">ul</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token plain">state</span><span class="token punctuation">.</span><span class="token plain">items</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">i</span><span class="token parameter punctuation">,</span><span class="token parameter"> k</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">=&gt;</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">            </span><span class="token tag punctuation">&lt;</span><span class="token tag class-name">Item</span><span class="token tag"> </span><span class="token tag attr-name">style</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript"> color</span><span class="token tag script language-javascript punctuation">:</span><span class="token tag script language-javascript"> </span><span class="token tag script language-javascript string">&#x27;red&#x27;</span><span class="token tag script language-javascript"> </span><span class="token tag script language-javascript punctuation">}</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag attr-name">store</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript keyword">this</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript">store</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag attr-name">key</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">k</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag attr-name">id</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">k</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag attr-name">data</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">i </span><span class="token tag script language-javascript operator">||</span><span class="token tag script language-javascript"> </span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">          </span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">        </span><span class="token tag punctuation">&lt;/</span><span class="token tag">ul</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">      </span><span class="token tag punctuation">&lt;/</span><span class="token tag">div</span><span class="token tag punctuation">&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><p>当某个自组件调用函数变更列表中某个对象类型值的属性时，触发重新渲染，如果数据是 <code>null</code> 的话，<code>data</code> 属性每次都是一个空对象 <code>{}</code>，<code>{}<!-- --> === <!-- -->{}</code> 是 <code>false</code>，这样会无端地让这几个子组件重新渲染。</p><p>最好为子组件设置 <code>defaultValue</code> 为 <code>{}</code>。</p><div class="__dumi-default-code-block"><pre class="prism-code language-jsx"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="static defaultValue = {}

const style = { color: &#x27;red&#x27; }

&lt;Item style={style} store={this.store} key={k} id={k} data={i || defaultValue} /&gt;
" data-status="copy"></button><div class="token-line"><span class="token keyword">static</span><span class="token plain"> defaultValue </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">const</span><span class="token plain"> style </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> color</span><span class="token punctuation">:</span><span class="token plain"> </span><span class="token string">&#x27;red&#x27;</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token tag punctuation">&lt;</span><span class="token tag class-name">Item</span><span class="token tag"> </span><span class="token tag attr-name">style</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">style</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag attr-name">store</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript keyword">this</span><span class="token tag script language-javascript punctuation">.</span><span class="token tag script language-javascript">store</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag attr-name">key</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">k</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag attr-name">id</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">k</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag attr-name">data</span><span class="token tag script language-javascript script-punctuation punctuation">=</span><span class="token tag script language-javascript punctuation">{</span><span class="token tag script language-javascript">i </span><span class="token tag script language-javascript operator">||</span><span class="token tag script language-javascript"> defaultValue</span><span class="token tag script language-javascript punctuation">}</span><span class="token tag"> </span><span class="token tag punctuation">/&gt;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="与内置生命周期函数冲突"><a aria-hidden="true" href="#与内置生命周期函数冲突"><span class="icon icon-link"></span></a>与内置生命周期函数冲突</h3><p>继承 PureComponent 时，不能为组件添加 <code>shouldComponentUpdate</code> 生命周期函数，否则会引发警告。</p><p>如果 PureComponent 里含有 <code>shouldComponentUpdate</code> 函数的话，会直接使用 <code>shouldComponentUpdate</code> 的结果作为是否重新渲染的依据，没有 <code>shouldComponentUpdate</code> 函数的话，才会判断是否为 PureComponent，是的话再作 <code>shallowEqual</code> 比较。</p><div class="__dumi-default-code-block"><pre class="prism-code language-jsx"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="// 这个变量用来控制组件是否需要更新
var shouldUpdate = true;

// inst 是组件实例
if (inst.shouldComponentUpdate) {
  shouldUpdate = inst.shouldComponentUpdate(nextProps, nextState, nextContext);
} else {
  if (this._compositeType === CompositeType.PureClass) {
    shouldUpdate = !shallowEqual(prevProps, nextProps) || !shallowEqual(inst.state, nextState);
  }
}
" data-status="copy"></button><div class="token-line"><span class="token comment">// 这个变量用来控制组件是否需要更新</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">var</span><span class="token plain"> shouldUpdate </span><span class="token operator">=</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token comment">// inst 是组件实例</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token plain">inst</span><span class="token punctuation">.</span><span class="token plain">shouldComponentUpdate</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  shouldUpdate </span><span class="token operator">=</span><span class="token plain"> inst</span><span class="token punctuation">.</span><span class="token function">shouldComponentUpdate</span><span class="token punctuation">(</span><span class="token plain">nextProps</span><span class="token punctuation">,</span><span class="token plain"> nextState</span><span class="token punctuation">,</span><span class="token plain"> nextContext</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword">else</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token keyword">if</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token plain">_compositeType </span><span class="token operator">===</span><span class="token plain"> CompositeType</span><span class="token punctuation">.</span><span class="token plain">PureClass</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">    shouldUpdate </span><span class="token operator">=</span><span class="token plain"> </span><span class="token operator">!</span><span class="token function">shallowEqual</span><span class="token punctuation">(</span><span class="token plain">prevProps</span><span class="token punctuation">,</span><span class="token plain"> nextProps</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token operator">||</span><span class="token plain"> </span><span class="token operator">!</span><span class="token function">shallowEqual</span><span class="token punctuation">(</span><span class="token plain">inst</span><span class="token punctuation">.</span><span class="token plain">state</span><span class="token punctuation">,</span><span class="token plain"> nextState</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h3 id="老版本兼容写法"><a aria-hidden="true" href="#老版本兼容写法"><span class="icon icon-link"></span></a>老版本兼容写法</h3><div class="__dumi-default-code-block"><pre class="prism-code language-js"><button title="" type="button" class="__dumi-default-icon __dumi-default-btn-copy __dumi-default-code-block-copy-btn" data-clipboard-text="import React { PureComponent, Component } from &#x27;react&#x27;;

class Foo extends (PureComponent || Component) {
  //...
}
" data-status="copy"></button><div class="token-line"><span class="token keyword module">import</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"> </span><span class="token maybe-class-name">PureComponent</span><span class="token punctuation">,</span><span class="token plain"> </span><span class="token maybe-class-name">Component</span><span class="token plain"> </span><span class="token punctuation">}</span><span class="token plain"> </span><span class="token keyword module">from</span><span class="token plain"> </span><span class="token string">&#x27;react&#x27;</span><span class="token punctuation">;</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token keyword">class</span><span class="token plain"> </span><span class="token class-name">Foo</span><span class="token plain"> </span><span class="token keyword">extends</span><span class="token plain"> </span><span class="token punctuation">(</span><span class="token maybe-class-name">PureComponent</span><span class="token plain"> </span><span class="token operator">||</span><span class="token plain"> </span><span class="token maybe-class-name">Component</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token punctuation">{</span><span class="token plain"></span></div><div class="token-line"><span class="token plain">  </span><span class="token comment">//...</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span><span class="token punctuation">}</span><span class="token plain"></span></div><div class="token-line"><span class="token plain"></span></div></pre></div><h2 id="同类型对比"><a aria-hidden="true" href="#同类型对比"><span class="icon icon-link"></span></a>同类型对比</h2><h3 id="与无状态组件对比"><a aria-hidden="true" href="#与无状态组件对比"><span class="icon icon-link"></span></a>与无状态组件对比</h3><p>无状态组件输入输出完全由 <code>props</code> 决定，而且不会产生任何副作用。</p><p>无状态组件可以通过减少继承 Component 而来的生命周期函数而达到性能优化的效果。从本质上来说，无状态组件就是一个单纯的 <code>render</code> 函数，所以无状态组件的缺点也是显而易见的。因为它没有 <code>shouldComponentUpdate</code> 生命周期函数，所以每次 <code>state</code> 更新，它都会重新绘制 <code>render</code> 函数。</p><blockquote><p>🖍 什么时候使用 <code>PureComponent</code>，什么时候使用无状态组件？</p></blockquote><p><code>PureComponent</code> 提高了性能，因为它减少了应用程序中的渲染操作次数，这对于复杂的 UI 来说是巨大的胜利，因此建议尽可能使用。此外，还有一些情况需要使用 <code>Component</code> 的声明周期方法，在这种情况下，我们不能使用无状态组件。</p><p>无状态组件易于实施且快速实施，它们适用于非常小的 UI 视图，其中重新渲染成本无关紧要。它们提供更清晰的代码和更少的文件来处理。</p><h3 id="与-memo-对比"><a aria-hidden="true" href="#与-memo-对比"><span class="icon icon-link"></span></a>与 memo 对比</h3><p><code>React.memo</code> 为高阶组件。它实现的效果与  <code>React.PureComponent</code> 相似，不同的是：</p><ul><li><code>React.memo</code> 用于函数组件</li><li><code>React.PureComponent</code> 适用于 class 组件</li><li><code>React.PureComponent</code> 只是浅比较 <code>props</code>、<code>state</code>，<code>React.memo</code> 也是浅比较，但它可以自定义比较函数</li></ul><hr/><p><strong>参考资料：</strong></p><ul><li><a href="http://www.wulv.site/2017-05-31/react-purecomponent.html" target="_blank" rel="noopener noreferrer">📝 React PureComponent 使用指南<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="http://www.wulv.site/2017-08-22/purecomponent-immutablejs.html" target="_blank" rel="noopener noreferrer">📝 当 PureComponent 遇上 ImmutableJS ，让 React 应用性能发挥到极致<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div><div class="__dumi-default-layout-footer-meta"><a target="_blank" rel="noopener noreferrer" href="https://github.com/tsejx/React-GuideBook/edit/master/docs/api-reference/react/pure-component.md">Edit this doc on GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="__dumi-default-external-link-icon"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a><span data-updated-text="Last Update: ">9/1/2020, 6:20:53 AM</span></div></div></div></div>
	<script>
  window.g_useSSR = true;
  window.g_initialProps = {};
	</script>

    <script src="/react-guidebook/umi.js"></script>
    <script src="/react-guidebook/docs__api-reference__react__pure-component.md.js"></script>
  </body>
</html>
